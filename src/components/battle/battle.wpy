<!--  -->
<template>
    <block wx:if="{{tutorialShow}}">
        <tutorial  @closeTutorial.user="closeTutorial"/>
    </block>
    <view class='container'>
        <view wx:if="{{removeOutter}}" bindanimationend='animationEnd' class="battle-container {{!loading?'fadeout':''}}" style="z-index:9999;">
            <view class="battle-box top">
                <view class="heart"></view>
                <view class="heart"></view>
            </view>
            <view class="battle-box bottom">
                <view class="heart"></view>
                <view class="heart"></view>
            </view>
        </view>
        <view class="battle-container ">
            <repeat key="index" for="{{battle.a}}">
                <view animation="{{item.animation}}" style="z-index:{{battle.a.length - index}};" id="{{item._id}}" class="battle-box top" @tap="fly('top',{{index}},{{item.image_id}},'')">
                    <image src="{{item.image}}" mode="aspectFill"></image>
                    <view class="info">
                        <view class="name">{{item.nick_name}}</view>
                        <view class="desc">{{item.gender=='male'?'男':'女'}} / {{item.age}} / {{item.constellation}}</view>
                        <view class="distance"><text>{{item.distance}}km</text>  {{item.city}}</view>
                    </view>
                </view>
            </repeat>
            <repeat for="{{battle.b}}" key="index">
                <view animation="{{item.animation}}" style="z-index:{{battle.b.length - index}};" id="{{item._id}}" class="battle-box bottom" @tap="fly('bottom',{{index}},{{item.image_id}},'')">
                    <image src="{{item.image}}" mode="aspectFill"></image>
                    <view class="info">
                        <view class="name">{{item.nick_name}}</view>
                        <view class="desc">{{item.gender=='male'?'男':'女'}} / {{item.age}} / {{item.constellation}}</view>
                        <view class="distance"><text>{{item.distance}}km</text>  {{item.city}}</view>
                    </view>
                </view>
            </repeat>
        </view>

        <view class="heart" wx:if="{{heartShow}}">
            <view class="top-heart {{heartTop?'active':''}}" wx:if="{{heartTop}}">
                <image src="{{topHeart}}" mode="aspectFill"></image>
            </view>
            <view class="bottom-heart {{heartBottom?'active':''}}" wx:if="{{heartBottom}}">
                <image src="{{bottomHeart}}" mode="aspectFill"></image>
            </view>
        </view>
    </view>
    <view class="box-layer" wx:if="{{layer}}">
        <view class="pop-box" wx:if="{{pop}}">
            <image class="image" src="../../images/battle/gift.png" mode="aspectFill"></image>
            <view class="text">您获得一份<text class="red">随机奖励</text></view>
            <view class="btn" @tap="checkGift">查看奖励</view>
        </view>
        <view class="gift-box" wx:if="{{gift}}">
            <image class="icon" src="../../images/profile/{{popType}}.png" mode="aspectFill"></image>
            <view class="text">喜欢次数 +{{popValue}}</view>
        </view>
    </view>
    <view class="divider">
        <image src="../../images/battle/devider.png" mode="aspectFill"></image>
    </view>
    <van-dialog id="van-dialog" />

</template>

<script>
import wepy from 'wepy';
import { BATTLE, BATTLE_COMMIT } from '@/utils/url';
import { get, post } from '@/utils/request';
import { Event } from '@/utils/event.js';
import empty from '@/components/empty';
import tutorial from './tutorial';
let emptyData = false;
export default class Battle extends wepy.component {
    data = {
        tutorialShow: false,
        loading: true,
        loaded: false,
        topLikedImage: '',
        bottomLikedImage: '',
        topLikedUser: '',
        bottomLikedUser: '',
        topIndex: 0,
        bottomIndex: 0,
        topHeart: '',
        bottomHeart: '',
        battle: {
            a: [],
            b: []
        },
        heartShow: false,
        heartTop: false,
        heartBottom: false,
        likeCount: {
            count: {}
        },
        animationData: {},
        removeOutter: true,
        popType: '',
        popValue: '',
        pop: false,
        gift: false,
        layer: false
    };

    components = {
        empty,
        tutorial
    };

    methods = {
        closeTutorial() {
            this.tutorialShow = false;
            wepy.setStorageSync('tutorial', true);
            this.$apply();
        },
        animationEnd() {
            this.removeOutter = false;
            this.$apply();
        },
        async fly(position, index, imageid, that, event) {
            var self = null;
            if (!that) {
                self = this;
            } else {
                self = that;
            }
            console.error(position);
            if (position == 'bottom') {
                if (self.topIndex == self.battle.a.length - 2) {
                    try {
                        await self.getBattle('a');
                    } catch (e) {
                        emptyData = true;
                    }
                }
                self.topIndex++;
                self.animation.translateX('-150%').step();
                self.battle.a[
                    self.topIndex - 1
                ].animation = self.animation.export();
                if (that) {
                    self.$apply();
                    return;
                }
                self.bottomLikedImage = self.battle.b[index].image_id;
                self.bottomLikedUser = self.battle.b[index]._id;
                console.error(self.bottomLikeImage);
            } else {
                if (self.bottomIndex == self.battle.b.length - 2) {
                    try {
                        await self.getBattle('b');
                    } catch (e) {
                        emptyData = true;
                    }
                }
                self.bottomIndex++;
                self.animation.translateX('-150%').step();
                self.battle.b[
                    self.bottomIndex - 1
                ].animation = self.animation.export();
                if (that) {
                    self.$apply();
                    return;
                }
                self.topLikedImage = self.battle.a[index].image_id;
                self.topLikedUser = self.battle.a[index]._id;
            }

            let likedImageId =
                position == 'bottom'
                    ? self.bottomLikedImage
                    : self.topLikedImage;
            let likedUserId =
                position == 'bottom' ? self.bottomLikedUser : self.topLikedUser;
            self.flyHeart(position, imageid);
            var notLikeImageId = '';
            if (position == 'bottom') {
                notLikeImageId = self.battle.a[self.topIndex - 1].image_id;
            } else {
                notLikeImageId = self.battle.b[self.bottomIndex - 1].image_id;
            }
            this.battleCommit(likedImageId, notLikeImageId);
            if (self.likeCount.count[likedImageId] == 2) {
                setTimeout(() => {
                    self.likeCount.count = {};
                    self.setHeart('top', 1);
                    self.setHeart('bottom', 1);
                    var idx = '';
                    if (position == 'bottom') {
                        idx = self.bottomIndex;
                    } else {
                        idx = self.topIndex;
                    }
                    wepy.navigateTo({
                        url: `battle/profile?id=${likedUserId}&index=${idx}&position=${position == 'bottom' ? 'top' : 'bottom'}`
                    });
                }, 1000);
            }
            self.handleEmpty();
        },
        checkGift() {
            this.pop = false;
            this.gift = true;
            setTimeout(() => {
                this.layer = false;
                this.pop = false;
                this.gift = false;
                this.$apply();
            }, 2000);
        }
    };
    handleEmpty() {
        // console.error(empty);
        if (emptyData) {
            setTimeout(async () => {
                emptyData = false;
                this.battle.a = [];
                this.battle.b = [];
                this.$apply();
                await this.getBattle();
                this.topIndex = 0;
                this.bottomIndex = 0;
                this.$apply();
            }, 200);
        }
    }
    async battleCommit(likedImageId, notLikeImageId) {
        try {
            const data = await post(BATTLE_COMMIT, {
                result: {
                    win: likedImageId,
                    fail: notLikeImageId
                }
            });

            setTimeout(() => {
                if (Object.keys(data).length) {
                    this.popType = Object.keys(data);
                    this.popValue = Object.values(data);
                    this.pop = true;
                    this.layer = true;
                    this.$apply();
                }
            }, 1000);
        } catch (e) {}
    }
    flyHeart(type) {
        this.heartShow = true;
        var imageid = '';
        if (type == 'bottom') {
            this.heartBottom = true;
            imageid = this.bottomLikedImage;
        } else {
            this.heartTop = true;
            imageid = this.topLikedImage;
        }
        console.error(imageid);
        if (!this.likeCount.count[imageid]) this.likeCount.count[imageid] = 0;
        this.likeCount.count[imageid] = this.likeCount.count[imageid] + 1;
        this.setHeart(type, this.likeCount.count[imageid]);
        setTimeout(() => {
            this.heartTop = false;
            this.heartBottom = false;
            this.heartShow = false;
            this.$apply();
        }, 700);
    }
    delay() {
        return new Promise(function(resolve, reject) {
            setTimeout(resolve.bind(null, 10), 300);
        });
    }
    events = {};

    watch = {};

    computed = {};
    getBattle(position = '') {
        return new Promise(async (resolve, reject) => {
            const result = await get(BATTLE, {
                battle: position
            });
            if (
                (position === 'a' && !result.a.length) ||
                (position === 'b' && !result.b.length)
            ) {
                reject('empty');
                return;
            }
            if (!position || position === 'a') {
                result.a.forEach(item => {
                    item.distance = (item.distance / 1000).toFixed(2);
                    item.animation = {};
                });

                this.battle.a.push(...result.a);
            }
            if (!position || position === 'b') {
                result.b.forEach(item => {
                    item.distance = (item.distance / 1000).toFixed(2);
                    item.animation = {};
                });
                this.battle.b.push(...result.b);
            }
            setTimeout(() => {
                this.loading = false;
                this.$apply();
            }, 3500);

            this.$apply();
            resolve();
        });
    }
    async onLoad() {
        Event.listen('battleFresh', () => {
            this.battle.a = [];
            this.battle.b = [];
            this.$apply();
            this.getBattle();
        });
        Event.listen('changeBattle', async (index, position) => {
            var imgId = '';
            console.error(position);
            console.error(index);

            var indexNext = index - 0 + 1;

            console.error(this.battle.a[indexNext].image_id);
            if (position == 'top') {
                if (!this.battle.a[indexNext].image_id) {
                    await this.getBattle('a');
                }
                imgId = this.battle.a[indexNext].image_id;
            } else {
                if (!this.battle.b[indexNext].image_id) {
                    await this.getBattle('b');
                }
                imgId = this.battle.b[indexNext].image_id;
            }
            setTimeout(() => {
                this.methods.fly(position, indexNext, imgId, this);
            }, 300);
        });
        this.animation = wx.createAnimation({
            duration: 300,
            timingFunction: 'ease-in'
        });
        await this.getBattle();
        this.loaded = true;
        this.topLikedImage = this.battle.a[this.battle.a.length - 1].image_id;
        this.topLikedUser = this.battle.a[this.battle.a.length - 1]._id;
        this.bottomLikedImage = this.battle.b[
            this.battle.b.length - 1
        ].image_id;
        this.bottomLikedUser = this.battle.b[this.battle.b.length - 1]._id;
        this.$apply();
        // if (!wepy.getStorageSync('isNew')) {
        //     try {
        //         await dialog({
        //             message:
        //                 '您是第一次使用颜狗小程序,需要了解一下颜狗的使用介绍么?',
        //             confirmButtonText: '去看看',
        //             showCancelButton: true,
        //             cancelButtonText: '不用了'
        //         });
        //         console.log('1');
        //     } catch (e) {
        //         console.log(2);
        //     }
        // }
        if (!wepy.getStorageSync('tutorial')) {
            this.tutorialShow = true;
        }
        const { windowWidth } = await wepy.getSystemInfo();
        console.log(windowWidth);
    }
    setHeart(position, index) {
        if (index === 2) {
            index = 3;
        }
        if (position === 'top') {
            this.topHeart = `../../../images/battle/${index}.png`;
        } else {
            this.bottomHeart = `../../../images/battle/${index}.png`;
        }
        this.$apply();
    }
    onShow() {}
}
</script>

<style lang='less' scoped>
.box-layer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 99999;
    background: rgba(0, 0, 0, 0.55);
    .pop-box {
        margin: 254rpx auto;
        width: 470rpx;
        height: 509rpx;
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        background: rgba(255, 255, 255, 1);
        .image {
            width: 290rpx;
            height: 290rpx;
            display: block;
        }
        .text {
            margin-top: 2rpx;
            font-size: 32rpx;
            color: #060706;
            .red {
                color: #df062e;
            }
        }
        .btn {
            width: 392rpx;
            height: 78rpx;
            line-height: 78rpx;
            text-align: center;
            font-weight: 500;
            background: rgba(223, 6, 46, 1);
            color: #fcfcfc;
            font-size: 28rpx;
        }
    }
    .gift-box {
        width: 480rpx;
        height: 195rpx;
        margin: 353rpx auto;
        display: flex;
        justify-content: center;
        align-items: center;
        background: white;
        color: #707070;
    }
    .icon {
        width: 96rpx;
        height: 96rpx;
    }
    .text {
        margin-left: 26rpx;
        font-size: 32rpx;
        font-weight: 400;
        color: rgba(30, 30, 30, 1);
    }
}
.divider {
    position: absolute;
    top: 532rpx;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 690rpx;
    height: 100rpx;
    z-index: 99998;
    image {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
}
.container {
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
    box-sizing: border-box;
    width: 100%;
    overflow: hidden;
    .heart {
        display: flex;
        flex-direction: column;
        width: 100%;
        height: 200vh;
        position: absolute;
        z-index: 9999;
        .top-heart,
        .bottom-heart {
            position: absolute;
            left: 50%;
            top: 200rpx;
            transform: translateX(-50%);
            image {
                width: 180rpx;
                height: 180rpx;
            }
        }
        .bottom-heart {
            top: 700rpx;
        }
        .bottom-heart.active,
        .top-heart.active {
            animation: flashHeart .6s ease-in-out 1;
            animation-fill-mode: both;
        }
        @keyframes flashHeart {
            /** 第一种写法**/
            0% {
                opacity: 0;
                transform: translateX(-50%) scale(0.4, 0.4);
            }
            30% {
                opacity: 1;
                transform: translateX(-50%) scale(1, 1);
            }
            70% {
                opacity: 1;
                transform: translateX(-50%) scale(1, 1);
            }
            100% {
                opacity: 0;
                transform: translateX(-50%) scale(0.4, 0.4);
            }
        }
    }
    image {
        width: 100%;
        height: 100%;
    }

    .battle-container {
        width: 690rpx;
        display: flex;
        flex-direction: column;
        align-items: center;
        position: absolute;
        height: 1064rpx;
        background: black;
        border-radius: 36rpx;
        &.fadeout {
            animation: containerOut 1s ease-in-out 1;
            animation-fill-mode: both;
        }
        @keyframes containerOut {
            0% {
                opacity: 1;
            }
            100% {
                opacity: 0;
            }
        }

        .battle-box {
            width: 690rpx;
            height: 532rpx;
            opacity: 1;
            overflow: hidden;
            margin: 0 auto;
            position: absolute;
            z-index: 999;
            .heart {
                background: url('data:image/png;base64,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');
                width: 100rpx;
                height: 80rpx;
                background-size: 100% 100%;
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                &:nth-child(1) {
                    animation: loadingHeart 2s ease-in-out infinite;
                }
                &:nth-child(2) {
                    animation: loadingHeart2 2s ease-in-out infinite;
                }
                animation-fill-mode: both;
            }
            @keyframes loadingHeart2 {
                0% {
                    transform: translate(-50%, -50%) scale(1, 1);
                    opacity: 0.4;
                }
                15% {
                    transform: translate(-50%, -50%) scale(1.3, 1.3);
                    opacity: 0.4;
                }
                25% {
                    transform: translate(-50%, -50%) scale(1, 1);
                    opacity: 0.4;
                }
                35% {
                    transform: translate(-50%, -50%) scale(1.3, 1.3);
                    opacity: 0.4;
                }
                45% {
                    transform: translate(-50%, -50%) scale(1, 1);
                    opacity: 0.4;
                }
                // 50%{
                //     transform:translate(-50%,-50%) scale(1,1);
                // }
                // 75%{
                //     transform:translate(-50%,-50%) scale(0.5,0.5);
                // }
                100% {
                    transform: translate(-50%, -50%) scale(1, 1);
                }
            }
            @keyframes loadingHeart {
                0% {
                    transform: translate(-50%, -50%) scale(1, 1);
                }
                10% {
                    transform: translate(-50%, -50%) scale(1.3, 1.3);
                }
                20% {
                    transform: translate(-50%, -50%) scale(1, 1);
                }
                30% {
                    transform: translate(-50%, -50%) scale(1.2, 1.2);
                }
                40% {
                    transform: translate(-50%, -50%) scale(1, 1);
                }
                // 50%{
                //     transform:translate(-50%,-50%) scale(1,1);
                // }
                // 75%{
                //     transform:translate(-50%,-50%) scale(0.5,0.5);
                // }
                100% {
                    transform: translate(-50%, -50%) scale(1, 1);
                }
            }
            &.an {
                animation: fade 0.6s ease-in 1;
                animation-fill-mode: both;
            }
            @keyframes fade {
                0% {
                    opacity: 0;
                }
                100% {
                    opacity: 1;
                }
            }
            &.active {
                animation: flyAway 0.3s ease-in 1;
                animation-fill-mode: both;
            }
            @keyframes flyAway {
                0% {
                    transform: translateX(0);
                }
                100% {
                    transform: translateX(-150%);
                }
            }
            .info {
                position: absolute;
                left: 18rpx;
                bottom: 40rpx;
                color: white;
                font-size: 22rpx;
                font-weight: 800;
                text-shadow: 0px 1rpx 3rpx rgba(0, 0, 0, 0.47);
                .name {
                    font-size: 48rpx;
                    text-shadow: 0px 3rpx 3rpx rgba(0, 0, 0, 0.47);
                }
                .distance {
                    text {
                        color: #FFC125;
                        text-shadow: 0px 1rpx 3rpx rgba(0, 0, 0, 0.47);
                    }
                }
            }
            &.top {
                border-radius: 36rpx 36rpx 0rpx 0rpx;
                // image {
                //     border-radius: 36rpx 36rpx 0rpx 0rpx;
                // }
            }
            &.bottom {
                border-radius: 0rpx 0rpx 36rpx 36rpx;
                top: 50%;
                // image {
                //     border-radius: 0rpx 0rpx 36rpx 36rpx;
                // }
            }
        }
    }
}
</style>
